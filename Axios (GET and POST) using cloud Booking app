<!-- Cloud crud crud link: only daily what to do is clear storage data to refresh requests count to 0
"https://crudcrud.com/api/2253a4874fff4b598043a89b5bc3bdea/appointmentData" -->

<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">
  <title>appointment Booking App</title>
  <!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/css/bootstrap.min.css" 
integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
  <style>
    html, body {
  height: 100%;
  width: 100%;
}
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: Arial, Helvetica, sans-serif;
  line-height: 1.6;
}

header {
  background: #f4f4f4;
  padding: 1rem;
  text-align: center;
}

.container {
  margin: auto;
  width: 500px;
  overflow: auto;
  padding: 3rem 2rem;
}

#my-form {
  padding: 2rem;
  background: #f4f4f4;
}

#my-form label {
  display: block;
}

#my-form input[type='text'], .input {
  width: 100%;
  padding: 8px;
  margin-bottom: 10px;
  border-radius: 5px;
  border: 1px solid #ccc;
}

.btn {
  display: block;
  width: 100%;
  padding: 10px 15px;
  border: 0;
  background: #333;
  color: #fff;
  border-radius: 5px;
  margin: 5px 0;
}

.btn:hover {
  background: #444;
}

.bg-dark {
  background: #333;
  color: #fff;
}

.error {
  background: orangered;
  color: #fff;
  padding: 5px;
  margin: 5px;
}
  table#listOfUsers {
    display: flex;
    justify-content: center;
  }
  
  </style>
</head>

<body>
  <header>
    <h1>Appointment Booking</h1>
  </header>

  <section class="container">
    <form id="my-form" onsubmit="saveToCloudCrudCrud(event)">
      <h1>Add User</h1>
      <div class="msg"></div>
      <div>
        <label for="name">Name:</label>
        <input type="text" class="input" id="username" required />
      </div>
      <div>
        <label for="email">Email:</label>
        <input type="email" class="input" id="emailId" required />
      </div>
      <div>
        <label for="phone">Phone No.:</label>
        <input type="phone" class="input" id="phonenumber" required />
      </div>
      <input class="btn" type="submit" value="Submit">
    </form>
  </section>
  <div class="userslist">
    <!-- <ul id="listOfUsers"></ul> -->
    <table class="table table-striped mt-3 mb-0" id="listOfUsers"></table>
  </div>
 
<script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.1.3/axios.min.js" ></script>
  <script>
    showuserlist();

//add user    
    function saveToCloudCrudCrud(event) {
      event.preventDefault();
      let name=event.target.username.value;
      let email=event.target.emailId.value;
      let phonenumber=event.target.phonenumber.value;
      
      let obj={
        name, email, phonenumber
      }

      //TO STORE DATA ON CRUD CRUD USING AXIOS
      axios.post("https://crudcrud.com/api/2253a4874fff4b598043a89b5bc3bdea/appointmentData",obj)
            .then((res)=>{
              showuserlist();
              console.log(res);
              name="";
              email="";
              phonenumber=""; 
            })
          .catch((err)=>{
          document.body.innerHTML=document.body.innerHTML+` Something went wrong with the server. Please try after some time`;
          console.log(err) 
          })
        }
        
//showuserList
    function showuserlist(){     
      axios.get("https://crudcrud.com/api/2253a4874fff4b598043a89b5bc3bdea/appointmentData")
      .then((res)=>{
        if(res.data.length!=0){
          let addeduserlist = document.getElementById("listOfUsers");
          let html = '';
          let index;
          res.data.forEach((item, index) => {
          //  index=item.id;
            console.log(item.id);
            html += `<tr>
                    <td>${item.name}  | ${item.email} | ${item.phonenumber}</td>
                    <td><button type="button"  class="text-primary"><i class="fa fa-edit"></i>Edit</button></td>
                    <td><button type="button"  class="text-danger"><i class="fa fa-trash"></i>Delete</button></td>
                </tr>`;            
              });
        addeduserlist.innerHTML = html;
        }
      })
      .catch((err)=>{
           addeduserlist.innerHTML=`<tr>
                    <td>${err}</td>
                    </tr> `;
           console.log(err);
      })
    }

    </script>
    </body>
    </html>
